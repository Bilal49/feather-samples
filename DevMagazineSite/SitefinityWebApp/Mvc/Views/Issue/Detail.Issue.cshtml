@model Telerik.Sitefinity.Frontend.Mvc.Models.ContentDetailsViewModel

@using Telerik.Sitefinity.Libraries.Model;
@using Telerik.Sitefinity.DynamicModules.Model;
@using Telerik.Sitefinity.RelatedData;
@using Telerik.Sitefinity.Model;
@using DevMagazine.Core.Mvc.Helpers;
@using Telerik.Sitefinity.News.Model;
@using SitefinityWebApp.Mvc.ViewModels;

@{
    var item = (Telerik.Sitefinity.DynamicModules.Model.DynamicContent)Model.Item.DataItem;
    var featuredArticle = item.GetRelatedItems<NewsItem>("FeaturedArticle").Single();
    var author = (Telerik.Sitefinity.DynamicModules.Model.DynamicContent)featuredArticle.GetRelatedItems<Telerik.Sitefinity.DynamicModules.Model.DynamicContent>("ArticleAuthor").Single();
}

<div class="Main-content">
    <div class="section">
        <div class="container text-center">
            <div class="row">
                <div class="col-md-8 col-md-offset-2">
                    <h4>@item.GetString("IssueNumber")</h4>
                    <h1>@item.GetString("Title")</h1>
                </div>
            </div>

            @{
                var cover = item.GetRelatedItems<Image>("IssueCover").FirstOrDefault();
                var document = item.GetRelatedItems<Document>("IssueDocument").FirstOrDefault();
            }

            <div class="Issue-cover">
                @Html.RenderImage(cover, "", "400", "428")
            </div>

            <a href="@document.MediaUrl" class="Btn Btn--download-issue-2">Download</a>
        </div>
    </div>

    <section class="Section">

        <div class="container">

            <div class="row">
                <div class="col-md-8">
                    <a href="@Html.GetItemDefaultUrl(featuredArticle)">
                        @Html.RenderImage(featuredArticle.GetRelatedItems<Image>("Image").SingleOrDefault(), "", "198", "780")
                    </a>
                </div>
                <div class="col-md-4">
                    <h4>Featured</h4>
                    <h2><a href="@Html.GetItemDefaultUrl(featuredArticle)">@featuredArticle.Title</a></h2>
                    <p>@Html.Raw(@featuredArticle.Summary)</p>
                    <a href="@Html.GetItemDefaultUrl(featuredArticle)">Read more</a>
                    @Html.Partial("_FeaturedArticle.Author", AuthorViewModel.GetAuthorViewModel(author))
                </div>
            </div>
        </div>
    </section>
    <section>

        <div class="container">

            <h4>Issue articles</h4>
            <hr>
            @Html.Partial("_RecentByTopic.Author", item.GetRelatedItems<NewsItem>("Articles").ToList())
        </div>
    </section>
</div>
